<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="version">
	<!-- 添加发布版本 -->
	<insert id="insert" parameterType="com.feidee.entity.Version" useGeneratedKeys="true">
		insert into 
		   t_release_version (publisher,content,versionNum,projectName,createTime) 
		values
		   (#{publisher},#{content},#{versionNum},#{projectName},#{createTime})
	</insert>
	
	<!-- 更新发布版本 -->
	<update id="update" parameterType="com.feidee.entity.Version">
		UPDATE t_release_version 
		SET publisher = #{publisher}, content = #{content}, versionNum = #{versionNum}, projectName = #{projectName}
		WHERE id = #{id}
	</update>
	
	<!-- 更新发布时间及状态-->
	<update id="updatePublishTime" parameterType="com.feidee.entity.Version">
		UPDATE t_release_version 
		SET createTime = #{createTime}, status = #{status}
		WHERE id = #{id}
	</update>
	
	<!-- 查询发布记录 -->
	<select id="getVersionById" parameterType="int" resultType="com.feidee.entity.Version">
		SELECT
			id, publisher, content, versionNum, createTime, updateTime, status, client, projectName
		FROM
			t_release_version
		WHERE
			id = #{_parameter}
	</select>
	
	<!-- 查询所有的发布记录 -->
	<select id="getAllVersion" resultType="com.feidee.entity.Version" parameterType="String">
		SELECT
			id, publisher, content, versionNum, createTime, updateTime, status, client, projectName
		FROM
			t_release_version
		 <if test="_parameter != null">
		     WHERE projectName = #{_parameter}
		  </if>
		ORDER BY createTime DESC
	</select>
	<!-- 根据工程名查询对应的发布记录 -->
	<select id="getVersionlistByProjectName" resultType="com.feidee.entity.Version">
		SELECT
			id, publisher, content, versionNum, createTime, updateTime, status, client, projectName
		FROM
			t_release_version
		WHERE
			projectName = #{_parameter}
		ORDER BY 
		    createTime DESC
	</select>
	<!-- 根据ID删除对应的发布记录 -->
	<delete id="deleteVersionById" parameterType="int">
		DELETE FROM
			t_release_version
		WHERE
			id = #{_parameter}
	</delete>
</mapper>